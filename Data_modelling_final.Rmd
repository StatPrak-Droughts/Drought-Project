---
title: "Data_modelling_final"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
renv::restore()
set.seed(42)
library(tidyverse)
library(mgcv)
library(lubridate)
library(timetk)
library(RcppRoll)
library(dLagM)
library(dlnm)
library(zoo)
theme_set(theme_gray())
library(knitr)
library(kableExtra)
library(sf)
library(tmap)
library(gridExtra)
library(lubridate)
library(timetk)
library(RcppRoll)
library(dLagM)
library(dlnm)
library(zoo)
theme_set(theme_gray())
library(js)
library(sjPlot)
library(verification)
library(ROCR)
library(pROC)
# Read data
source("data_read.R")
```

# Volle Modelle für alle Pegel und Halbjahre
```{r}
gam2_all_winter_10304 <- gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML")
summary(gam2_all_winter_10304)
AIC(gam2_all_winter_10304)

gam2_all_summer_10304 <- gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML")
summary(gam2_all_summer_10304)
AIC(gam2_all_summer_10304)

gam_all_winter_11502 <- gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML")
summary(gam_all_winter_11502)
AIC(gam_all_winter_11502)

gam_all_summer_11502 <- gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML")
summary(gam_all_summer_11502)
AIC(gam_all_summer_11502)


gam_all_winter_20203 <- gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML")
summary(gam_all_winter_20203)
AIC(gam_all_winter_20203)


gam_all_summer_20203 <- gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML")
summary(gam_all_summer_20203)
AIC(gam_all_summer_20203)




```

## AIC Vergleich der vollen Modelle
``` {r}
# 10304 Winter
## Niederschlag Gruppe entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

## Lufttemp. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

## Strahlung und rel. Luftfeuchte entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

## Bodenfeuchte entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

## Schneegruppe entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

## Grundwasserstand entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

# 10304 Sommer
## Niederschlag Gruppe entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML"))

## Lufttemp. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML"))

## Strahlung und rel. Luftfeuchte entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML"))

## Bodenfeuchte entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML"))

## Schneegruppe entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML"))

## Grundwasserstand entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML"))


# 20203 Winter
## Niederschlag Gruppe entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML"))

## Lufttemp. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML"))

## Strahlung und rel. Luftfeuchte entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML"))

## Bodenfeuchte entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML"))

## Schneegruppe entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML"))

## Grundwasserstand entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML"))

# 20203 Sommer
## Niederschlag Gruppe entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML"))

## Lufttemp. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML"))

## Strahlung und rel. Luftfeuchte entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML"))

## Bodenfeuchte entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML"))

## Schneegruppe entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML"))

## Grundwasserstand entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML"))


# 11502 Winter
## Niederschlag Gruppe entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML"))

## Lufttemp. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML"))

## Strahlung und rel. Luftfeuchte entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML"))

## Bodenfeuchte entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML"))

## Schneegruppe entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML"))

## Grundwasserstand entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML"))

# 11502 Sommer
## Niederschlag Gruppe entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML"))

## Lufttemp. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML"))

## Strahlung und rel. Luftfeuchte entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML"))

## Bodenfeuchte entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML"))

## Schneegruppe entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML"))

## Grundwasserstand entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(avg_infiltration, bs = "ps") + s(max_precip, bs = "ps") + s(avg_snowstorage_drain, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML"))

```







# Selektierte Modelle für alle Pregel und Halbjahre (Selected 1)
```{r}
# nur Treiber: avg_precip, avg_airtmp, avg_glorad, avg_soilwater, avg_snowstorage, groundwaterdepth um Multikollinearität zu vermeiden (in keinem der 6 Datensätze eine Korrelation von > 0.8 bzw. <-0.8)
gam_uni_selected_winter_10304 <- gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML")
summary(gam_uni_selected_winter_10304)
AIC(gam_uni_selected_winter_10304)
BIC(gam_uni_selected_winter_10304)
concurvity(gam_uni_selected_winter_10304)
#plot(gam_uni_selected_winter_10304, ylim = c(-7, 7))


gam_uni_selected_summer_10304 <- gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML")
summary(gam_uni_selected_summer_10304)
AIC(gam_uni_selected_summer_10304)
BIC(gam_uni_selected_summer_10304)
concurvity(gam_uni_selected_summer_10304)
#plot(gam_uni_selected_summer_10304, ylim = c(-7, 7))


gam_uni_selected_winter_11502 <- gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML")
summary(gam_uni_selected_winter_11502)
AIC(gam_uni_selected_winter_11502)
BIC(gam_uni_selected_winter_11502)
concurvity(gam_uni_selected_winter_11502)
#plot(gam_uni_selected_winter_11502, ylim = c(-7, 7))


gam_uni_selected_summer_11502 <- gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML")
summary(gam_uni_selected_summer_11502)
AIC(gam_uni_selected_summer_11502)
BIC(gam_uni_selected_summer_11502)
concurvity(gam_uni_selected_summer_11502)
#plot(gam_uni_selected_summer_11502, ylim = c(-7, 7))


gam_uni_selected_winter_20203 <- gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML")
summary(gam_uni_selected_winter_20203)
AIC(gam_uni_selected_winter_20203)
BIC(gam_uni_selected_winter_20203)
concurvity(gam_uni_selected_winter_20203)
#plot(gam_uni_selected_winter_20203, ylim = c(-7, 7))


gam_uni_selected_summer_20203 <- gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML")
summary(gam_uni_selected_summer_20203)
AIC(gam_uni_selected_summer_20203)
BIC(gam_uni_selected_summer_20203)
concurvity(gam_uni_selected_summer_20203)
#plot(gam_uni_selected_summer_20203, ylim = c(-7, 7))
```

## AIC Vergleich 1. selektiertes Model
``` {r}
#Winter 10304
## Niedschlag
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

# Lufttemp
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps")  + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

# Strahlung
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

# Bodenfeuchte
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps")+ s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

# Schneespeicher
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

#Grundwasserstand
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

#Sommer 10304 
## Niedschlag
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML"))

# Lufttemp
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps")  + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML"))

# Strahlung
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML"))

# Bodenfeuchte
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps")+ s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML"))

# Schneespeicher
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML"))

#Grundwasserstand
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML"))

#Winter 20203
## Niedschlag
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML"))

# Lufttemp
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps")  + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML"))

# Strahlung
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML"))

# Bodenfeuchte
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps")+ s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML"))

# Schneespeicher
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML"))

#Grundwasserstand
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML"))

#Sommer 20203
## Niedschlag
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML"))

# Lufttemp
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps")  + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML"))

# Strahlung
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML"))

# Bodenfeuchte
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps")+ s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML"))

# Schneespeicher
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML"))

#Grundwasserstand
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML"))

#Winter 11502
## Niedschlag
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML"))

# Lufttemp
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps")  + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML"))

# Strahlung
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML"))

# Bodenfeuchte
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps")+ s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML"))

# Schneespeicher
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML"))

#Grundwasserstand
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML"))

#Sommer 11502
## Niedschlag
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML"))

# Lufttemp
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps")  + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML"))

# Strahlung
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML"))

# Bodenfeuchte
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps")+ s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML"))

# Schneespeicher
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML"))

#Grundwasserstand
AIC(gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML"))
``` 



## Effect Plots
### Isar Winter
```{r}
# Isar Winter

# Soilwater
plot(gam_uni_selected_winter_10304, ylim = c(-7, 7), xlim = c(-6,6), xlab = "Rolling mean oberflächennahe rel. Bodenfeuchte \n (letzte 60 Tage; zentriert, skaliert)", select = 4, main = "Isar Mittenwald \n Effekt der mittleren oberfl. rel. Bodenfeuchte", ylab = "log. Odds")
# Glorad
plot(gam_uni_selected_winter_10304, ylim = c(-7, 7), xlim = c(-250, 600), xlab = "Rolling mean einfallende kurzwellige Strahlung \n (letzte 7 Tage; zentriert)", select = 3, main = "Isar Mittenwald \n Effekt der mittleren einfallenden kurzwelligen Strahlung", ylab = "log. Odds")
# Lufttemperatur
plot(gam_uni_selected_winter_10304, ylim = c(-7, 7), xlim = c(-15, 15), xlab = "Rolling mean Lufttemperatur \n (letzte 7 Tage; zentriert)", select = 2, main = "Isar Mittenwald \n Effekt der mittleren Lufttemperatur", ylab = "log. Odds")

```
### Saale Winter
```{r}
# Saale Winter

# Soilwater
plot(gam_uni_selected_winter_20203, ylim = c(-7, 7), xlim = c(-6, 6), xlab = "Rolling mean oberflächennahe rel. Bodenfeuchte \n (letzte 60 Tage; zentriert, skaliert)", select = 4, main = "Fränkische Saale Salz \n Effekt der mittleren oberfl. rel. Bodenfeuchte", ylab = "log. Odds")

# Glorad
plot(gam_uni_selected_winter_20203, ylim = c(-7, 7), xlab = "Rolling mean einfallende kurzwellige Strahlung \n (letzte 7 Tage; zentriert)", xlim = c(-250, 600), select = 3, main = "Fränkische Saale Salz \n Effekt der mittleren einfallenden kurzwelligen Strahlung", ylab = "log. Odds")

# Lufttemperatur
plot(gam_uni_selected_winter_20203, ylim = c(-7, 7), xlim = c(-15, 15), xlab = "Rolling mean Lufttemperatur \n (letzte 7 Tage; zentriert)", select = 2, main = "Fränkische Saale Salz \n Effekt der mittleren Lufttemperatur", ylab = "log. Odds")

```
### Isar Summer
```{r}
# Soilwater
plot(gam_uni_selected_summer_10304, ylim = c(-7, 7), xlim = c(-5, 2), xlab = "Rolling mean oberflächennahe rel. Bodenfeuchte \n (letzte 60 Tage; zentriert, skaliert)", select = 4, main = "Isar Mittenwald \n Effekt der mittleren oberfl. rel. Bodenfeuchte", ylab = "log. Odds")

# Snowstorage
plot(gam_uni_selected_summer_10304, ylim = c(-7, 7), xlim =  c(-50, 50), xlab = "Rolling mean Schneespeicher \n (letzte 30 Tage; zentriert)", select = 5, main = "Isar Mittenwald \n Effekt des mittleren Schneespeichers", ylab = "log. Odds")

# Niederschlag
plot(gam_uni_selected_summer_10304, ylim = c(-7, 7), xlim = c(-5, 5), xlab = "Rolling mean Niederschlag \n (letzte 7 Tage; zentriert)", select = 1, main = "Isar Mittenwald \n Effekt des mittleren Niederschlags", ylab = "log. Odds")
```
### Iller Summer
```{r}

# Soilwater
plot(gam_uni_selected_summer_11502, ylim = c(-7, 7), xlim = c(-5, 2), xlab = "Rolling mean oberflächennahe rel. Bodenfeuchte \n (letzte 60 Tage; zentriert, skaliert)", select = 4, main = "Iller Kempten \n Effekt der mittleren oberfl. rel. Bodenfeuchte", ylab = "log. Odds")

# Snowstorage
plot(gam_uni_selected_summer_11502, ylim = c(-7, 7), xlim =  c(-50, 50), xlab = "Rolling mean Schneespeicher \n (letzte 30 Tage; zentriert)", select = 5, main = "Iller Kempten \n Effekt des mittleren Schneespeichers", ylab = "log. Odds")

# Niederschlag
plot(gam_uni_selected_summer_11502, ylim = c(-7, 7), xlim = c(-5, 5), xlab = "Rolling mean Niederschlag \n (letzte 7 Tage; zentriert)", select = 1, main = "Iller Kempten \n Effekt des mittleren Niederschlags", ylab = "log. Odds")

```

# Selektierte Modelle für alle Pregel und Halbjahre (Selected 2)
```{r}
# nur Treiber: avg_airtmp, avg_relhum, avg_soilwater, avg_snowstorage, groundwaterdepth, avg_infiltration um Multikollinearität zu vermeiden (in keinem der 6 Datensätze eine Korrelation von > 0.8 bzw. <-0.8)
gam2_uni_selected_winter_10304 <- gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML")
summary(gam2_uni_selected_winter_10304)
AIC(gam2_uni_selected_winter_10304)
BIC(gam2_uni_selected_winter_10304)
concurvity(gam2_uni_selected_winter_10304)
#plot(gam2_uni_selected_winter_10304, ylim = c(-7, 7))


gam2_uni_selected_summer_10304 <- gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML")
summary(gam2_uni_selected_summer_10304)
AIC(gam2_uni_selected_summer_10304)
BIC(gam2_uni_selected_summer_10304)
concurvity(gam2_uni_selected_summer_10304)
#plot(gam2_uni_selected_summer_10304, ylim = c(-7, 7))


gam2_uni_selected_winter_11502 <- gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML")
summary(gam2_uni_selected_winter_11502)
AIC(gam2_uni_selected_winter_11502)
BIC(gam2_uni_selected_winter_11502)
concurvity(gam2_uni_selected_winter_11502)
#plot(gam2_uni_selected_winter_11502, ylim = c(-7, 7))


gam2_uni_selected_summer_11502 <- gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML")
summary(gam2_uni_selected_summer_11502)
AIC(gam2_uni_selected_summer_11502)
BIC(gam2_uni_selected_summer_11502)
concurvity(gam2_uni_selected_summer_11502)
#plot(gam2_uni_selected_summer_11502, ylim = c(-7, 7))


gam2_uni_selected_winter_20203 <- gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML")
summary(gam2_uni_selected_winter_20203)
AIC(gam2_uni_selected_winter_20203)
BIC(gam2_uni_selected_winter_20203)
concurvity(gam2_uni_selected_winter_20203)
#plot(gam2_uni_selected_winter_20203, ylim = c(-7, 7))


gam2_uni_selected_summer_20203 <- gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML")
summary(gam2_uni_selected_summer_20203)
AIC(gam2_uni_selected_summer_20203)
BIC(gam2_uni_selected_summer_20203)
concurvity(gam2_uni_selected_summer_20203)
#plot(gam2_uni_selected_summer_20203, ylim = c(-7, 7))
```



## AIC Vergleich 2. selektiertes Model
``` {r}
#Winter 10304
## Infiltr. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

## airtmp. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

## rel. hum. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

## soilwater entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

## snowstorage entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

## groundwaterdepth entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

#Sommer 10304
## Infiltr. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML"))

## airtmp. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML"))

## rel. hum. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML"))

## soilwater entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML"))

## snowstorage entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML"))

## groundwaterdepth entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML"))

#Winter 20203
## Infiltr. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML"))

## airtmp. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML"))

## rel. hum. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML"))

## soilwater entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML"))

## snowstorage entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML"))

## groundwaterdepth entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML"))

#Sommer 20203
## Infiltr. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML"))

## airtmp. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML"))

## rel. hum. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML"))

## soilwater entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML"))

## snowstorage entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML"))

## groundwaterdepth entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML"))

#Winter 11502
## Infiltr. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML"))

## airtmp. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML"))

## rel. hum. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML"))

## soilwater entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML"))

## snowstorage entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML"))

## groundwaterdepth entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML"))

#Sommer 11502
## Infiltr. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML"))

## airtmp. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML"))

## rel. hum. entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML"))

## soilwater entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML"))

## snowstorage entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML"))

## groundwaterdepth entfernt
AIC(gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML"))


``` 

# Selektierte Modelle für alle Pregel und Halbjahre mit individuellen Interaktionen
```{r}
# 10304, Winter
gam_uni_selected_interac_winter_10304 <- gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_relhum, bs = "ps")+ s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(avg_infiltration, bs = "ps") + s(avg_snowstorage_drain, bs = "ps") + s(groundwaterdepth, bs = "ps", by = avg_glorad), family = binomial(), data = hydro_winter_10304_kbe, method = "REML")
AIC(gam_uni_selected_interac_winter_10304)
summary(gam_uni_selected_interac_winter_10304)

# 10304, Summer
gam_uni_selected_interac_summer_10304 <- gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML")




# mit ti
# 10304, Winter
gam_uni_selected_interac_winter_10304 <- gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(avg_snowstorage_drain, bs = "ps") + ti(avg_glorad, avg_snowstorage, bs = "ps") + ti(avg_soilwater, groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_10304_kbe, method = "REML")
AIC(gam_uni_selected_interac_winter_10304)
summary(gam_uni_selected_interac_winter_10304)

# 10304, Summer
gam_uni_selected_interac_summer_10304 <- gam(formula = lowlevel ~ YY + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + ti(avg_soilwater, groundwaterdepth, bs = "ps") + ti(avg_airtmp, avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_10304_kbe, method = "REML")
AIC(gam_uni_selected_interac_summer_10304)
summary(gam_uni_selected_interac_summer_10304)

# 11502, Winter
gam_uni_selected_interac_winter_11502 <- gam(formula = lowlevel ~ YY + s(avg_precip, bs = "ps") + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(avg_snowstorage_drain, bs = "ps") + ti(avg_snowstorage, groundwaterdepth, bs = "ps"), family = binomial(), data = hydro_winter_11502_kbe, method = "REML")
AIC(gam_uni_selected_interac_winter_11502)
summary(gam_uni_selected_interac_winter_11502)

# 11502, Summer
gam_uni_selected_interac_summer_11502 <- gam(formula = lowlevel ~ YY  + s(avg_airtmp, bs = "ps") + s(avg_glorad, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + ti(avg_soilwater, groundwaterdepth, bs = "ps") + ti(avg_airtmp, avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_11502_kbe, method = "REML")
AIC(gam_uni_selected_interac_summer_11502)
summary(gam_uni_selected_interac_summer_11502)

# 20203, Winter
gam_uni_selected_interac_winter_20203 <- gam(formula = lowlevel ~ YY  + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(avg_snowstorage, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps") + s(avg_snowstorage_drain, bs = "ps") + ti(avg_airtmp, groundwaterdepth, bs = "ps") + ti(avg_soilwater, avg_snowstorage, bs = "ps"), family = binomial(), data = hydro_winter_20203_kbe, method = "REML")
AIC(gam_uni_selected_interac_winter_20203)
summary(gam_uni_selected_interac_winter_20203)

# 20203, Summer
# avg_snowstorage und avg_snowstorage_drain aufgrund von mangender Varianz in den Daten herausgenommen  
gam_uni_selected_interac_summer_20203 <- gam(formula = lowlevel ~ YY  + s(avg_airtmp, bs = "ps") + s(avg_relhum, bs = "ps") + s(avg_soilwater, bs = "ps") + s(groundwaterdepth, bs = "ps") + s(avg_infiltration, bs = "ps")  + ti(avg_soilwater, groundwaterdepth, bs = "ps") + ti(avg_airtmp, avg_infiltration, bs = "ps"), family = binomial(), data = hydro_summer_20203_kbe, method = "REML")
AIC(gam_uni_selected_interac_summer_20203)
summary(gam_uni_selected_interac_summer_20203)
```

# ROC Analysis
## Setup test set
```{r}
# Setup test set
hydro_winter_11502_test <- hydro_winter_11502 %>% filter(member != "kbe")
hydro_winter_11502_test$lowlevel <- as.logical(hydro_winter_11502_test$lowlevel)

hydro_summer_11502_test <- hydro_summer_11502 %>% filter(member != "kbe")
hydro_summer_11502_test$lowlevel <- as.logical(hydro_summer_11502_test$lowlevel)

hydro_winter_10304_test <- hydro_winter_10304 %>% filter(member != "kbe")
hydro_winter_10304_test$lowlevel <- as.logical(hydro_winter_10304_test$lowlevel)

hydro_summer_10304_test <- hydro_summer_10304 %>% filter(member != "kbe")
hydro_summer_10304_test$lowlevel <- as.logical(hydro_summer_10304_test$lowlevel)

hydro_winter_20203_test <- hydro_winter_20203 %>% filter(member != "kbe")
hydro_winter_20203_test$lowlevel <- as.logical(hydro_winter_20203_test$lowlevel)

hydro_summer_20203_test <- hydro_summer_20203 %>% filter(member != "kbe")
hydro_summer_20203_test$lowlevel <- as.logical(hydro_summer_20203_test$lowlevel)
```

## ROC Analysis for full models -----
```{r}
# 10304, winter
hydro_winter_10304_pred_full <- predict(gam2_all_winter_10304, hydro_winter_10304_test, type = "response")
roc.plot(hydro_winter_10304_test$lowlevel, hydro_winter_10304_pred_full, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_winter_10304_test$lowlevel, hydro_winter_10304_pred_full)
hydro_winter_10304_pred_full_lowlevel <- hydro_winter_10304_pred_full[which(hydro_winter_10304_test$lowlevel == 1)]
hist(hydro_winter_10304_pred_full_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Isar Mittenwald, Winter, Fälle: Niedrigwasserevent")
hydro_winter_10304_pred_full_not_lowlevel <- hydro_winter_10304_pred_full[-which(hydro_winter_10304_test$lowlevel == 1)]
hist(hydro_winter_10304_pred_full_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Isar Mittenwald, Winter, Fälle: kein Niedrigwasserevent")

# 10304, summer
hydro_summer_10304_pred_full <- predict(gam2_all_summer_10304, hydro_summer_10304_test, type = "response")
roc.plot(hydro_summer_10304_test$lowlevel, hydro_summer_10304_pred_full, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_summer_10304_test$lowlevel, hydro_summer_10304_pred_full)
hydro_summer_10304_pred_full_lowlevel <- hydro_summer_10304_pred_full[which(hydro_summer_10304_test$lowlevel == 1)]
hist(hydro_summer_10304_pred_full_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Isar Mittenwald, Sommer, Fälle: Niedrigwasserevent")
hydro_summer_10304_pred_full_not_lowlevel <- hydro_summer_10304_pred_full[-which(hydro_summer_10304_test$lowlevel == 1)]
hist(hydro_summer_10304_pred_full_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Isar Mittenwald, Sommer, Fälle: kein Niedrigwasserevent")

# 11502, winter
hydro_winter_11502_pred_full <- predict(gam_all_winter_11502, hydro_winter_11502_test, type = "response")
roc.plot(hydro_winter_11502_test$lowlevel, hydro_winter_11502_pred_full, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_winter_11502_test$lowlevel, hydro_winter_11502_pred_full)
hydro_winter_11502_pred_full_lowlevel <- hydro_winter_11502_pred_full[which(hydro_winter_11502_test$lowlevel == 1)]
hist(hydro_winter_11502_pred_full_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Iller Kempten, Winter, Fälle: Niedrigwasserevent")
hydro_winter_11502_pred_full_not_lowlevel <- hydro_winter_11502_pred_full[-which(hydro_winter_11502_test$lowlevel == 1)]
hist(hydro_winter_11502_pred_full_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Iller Kempten, Winter, Fälle: kein Niedrigwasserevent")

# 11502, summer
hydro_summer_11502_pred_full <- predict(gam_all_summer_11502, hydro_summer_11502_test, type = "response")
roc.plot(hydro_summer_11502_test$lowlevel, hydro_summer_11502_pred_full, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_summer_11502_test$lowlevel, hydro_summer_11502_pred_full)
hydro_summer_11502_pred_full_lowlevel <- hydro_summer_11502_pred_full[which(hydro_summer_11502_test$lowlevel == 1)]
hist(hydro_summer_11502_pred_full_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Iller Kempten, Sommer, Fälle: Niedrigwasserevent")
hydro_summer_11502_pred_full_not_lowlevel <- hydro_summer_11502_pred_full[-which(hydro_summer_11502_test$lowlevel == 1)]
hist(hydro_summer_11502_pred_full_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Iller Kempten, Sommer, Fälle: kein Niedrigwasserevent")

# 20203, winter
hydro_winter_20203_pred_full <- predict(gam_all_winter_20203, hydro_winter_20203_test, type = "response")
roc.plot(hydro_winter_20203_test$lowlevel, hydro_winter_20203_pred_full, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_winter_20203_test$lowlevel, hydro_winter_20203_pred_full)
hydro_winter_20203_pred_full_lowlevel <- hydro_winter_20203_pred_full[which(hydro_winter_20203_test$lowlevel == 1)]
hist(hydro_winter_20203_pred_full_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Fränkische Saale Salz, Winter, Fälle: Niedrigwasserevent")
hydro_winter_20203_pred_full_not_lowlevel <- hydro_winter_20203_pred_full[-which(hydro_winter_20203_test$lowlevel == 1)]
hist(hydro_winter_20203_pred_full_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Fränkische Saale Salz, Winter, Fälle: kein Niedrigwasserevent")

# 20203, summer
hydro_summer_20203_pred_full <- predict(gam_all_summer_20203, hydro_summer_20203_test, type = "response")
roc.plot(hydro_summer_20203_test$lowlevel, hydro_summer_20203_pred_full, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_summer_20203_test$lowlevel, hydro_summer_20203_pred_full)
hydro_summer_20203_pred_full_lowlevel <- hydro_summer_20203_pred_full[which(hydro_summer_20203_test$lowlevel == 1)]
hist(hydro_summer_20203_pred_full_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Fränkische Saale Salz, Sommer, Fälle: Niedrigwasserevent")
hydro_summer_20203_pred_full_not_lowlevel <- hydro_summer_20203_pred_full[-which(hydro_summer_20203_test$lowlevel == 1)]
hist(hydro_summer_20203_pred_full_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Fränkische Saale Salz, Sommer, Fälle: kein Niedrigwasserevent")
```

## ROC Analysis for first universally selected models ----
```{r}
# 10304, winter
hydro_winter_10304_pred_uni_1 <- predict(gam_uni_selected_winter_10304, hydro_winter_10304_test, type = "response")
roc.plot(hydro_winter_10304_test$lowlevel, hydro_winter_10304_pred_uni_1, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_winter_10304_test$lowlevel, hydro_winter_10304_pred_uni_1)
hydro_winter_10304_pred_uni_1_lowlevel <- hydro_winter_10304_pred_uni_1[which(hydro_winter_10304_test$lowlevel == 1)]
hist(hydro_winter_10304_pred_uni_1_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Isar Mittenwald, Winter, Fälle: Niedrigwasserevent")
hydro_winter_10304_pred_uni_1_not_lowlevel <- hydro_winter_10304_pred_uni_1[-which(hydro_winter_10304_test$lowlevel == 1)]
hist(hydro_winter_10304_pred_uni_1_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Isar Mittenwald, Winter, Fälle: kein Niedrigwasserevent")

# 10304, summer
hydro_summer_10304_pred_uni_1 <- predict(gam_uni_selected_summer_10304, hydro_summer_10304_test, type = "response")
roc.plot(hydro_summer_10304_test$lowlevel, hydro_summer_10304_pred_uni_1, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_summer_10304_test$lowlevel, hydro_summer_10304_pred_uni_1)
hydro_summer_10304_pred_uni_1_lowlevel <- hydro_summer_10304_pred_uni_1[which(hydro_summer_10304_test$lowlevel == 1)]
hist(hydro_summer_10304_pred_uni_1_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Isar Mittenwald, Sommer, Fälle: Niedrigwasserevent")
hydro_summer_10304_pred_uni_1_not_lowlevel <- hydro_summer_10304_pred_uni_1[-which(hydro_summer_10304_test$lowlevel == 1)]
hist(hydro_summer_10304_pred_uni_1_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Isar Mittenwald, Sommer, Fälle: kein Niedrigwasserevent")

# 11502, winter
hydro_winter_11502_pred_uni_1 <- predict(gam_uni_selected_winter_11502, hydro_winter_11502_test, type = "response")
roc.plot(hydro_winter_11502_test$lowlevel, hydro_winter_11502_pred_uni_1, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_winter_11502_test$lowlevel, hydro_winter_11502_pred_uni_1)
hydro_winter_11502_pred_uni_1_lowlevel <- hydro_winter_11502_pred_uni_1[which(hydro_winter_11502_test$lowlevel == 1)]
hist(hydro_winter_11502_pred_uni_1_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Iller Kempten, Winter, Fälle: Niedrigwasserevent")
hydro_winter_11502_pred_uni_1_not_lowlevel <- hydro_winter_11502_pred_uni_1[-which(hydro_winter_11502_test$lowlevel == 1)]
hist(hydro_winter_11502_pred_uni_1_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Iller Kempten, Winter, Fälle: kein Niedrigwasserevent")

# 11502, summer
hydro_summer_11502_pred_uni_1 <- predict(gam_uni_selected_summer_11502, hydro_summer_11502_test, type = "response")
roc.plot(hydro_summer_11502_test$lowlevel, hydro_summer_11502_pred_uni_1, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_summer_11502_test$lowlevel, hydro_summer_11502_pred_uni_1)
hydro_summer_11502_pred_uni_1_lowlevel <- hydro_summer_11502_pred_uni_1[which(hydro_summer_11502_test$lowlevel == 1)]
hist(hydro_summer_11502_pred_uni_1_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Iller Kempten, Sommer, Fälle: Niedrigwasserevent")
hydro_summer_11502_pred_uni_1_not_lowlevel <- hydro_summer_11502_pred_uni_1[-which(hydro_summer_11502_test$lowlevel == 1)]
hist(hydro_summer_11502_pred_uni_1_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Iller Kempten, Sommer, Fälle: kein Niedrigwasserevent")

# 20203, winter
hydro_winter_20203_pred_uni_1 <- predict(gam_uni_selected_winter_20203, hydro_winter_20203_test, type = "response")
roc.plot(hydro_winter_20203_test$lowlevel, hydro_winter_20203_pred_uni_1, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_winter_20203_test$lowlevel, hydro_winter_20203_pred_uni_1)
hydro_winter_20203_pred_uni_1_lowlevel <- hydro_winter_20203_pred_uni_1[which(hydro_winter_20203_test$lowlevel == 1)]
hist(hydro_winter_20203_pred_uni_1_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Fränkische Saale Salz, Winter, Fälle: Niedrigwasserevent")
hydro_winter_20203_pred_uni_1_not_lowlevel <- hydro_winter_20203_pred_uni_1[-which(hydro_winter_20203_test$lowlevel == 1)]
hist(hydro_winter_20203_pred_uni_1_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Fränkische Saale Salz, Winter, Fälle: kein Niedrigwasserevent")

# 20203, summer
hydro_summer_20203_pred_uni_1 <- predict(gam_uni_selected_summer_20203, hydro_summer_20203_test, type = "response")
roc.plot(hydro_summer_20203_test$lowlevel, hydro_summer_20203_pred_uni_1, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_summer_20203_test$lowlevel, hydro_summer_20203_pred_uni_1)
hydro_summer_20203_pred_uni_1_lowlevel <- hydro_summer_20203_pred_uni_1[which(hydro_summer_20203_test$lowlevel == 1)]
hist(hydro_summer_20203_pred_uni_1_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Fränkische Saale Salz, Sommer, Fälle: Niedrigwasserevent")
hydro_summer_20203_pred_uni_1_not_lowlevel <- hydro_summer_20203_pred_uni_1[-which(hydro_summer_20203_test$lowlevel == 1)]
hist(hydro_summer_20203_pred_uni_1_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Fränkische Saale Salz, Sommer, Fälle: kein Niedrigwasserevent")
```

## ROC Analysis for second universally selected models -----
```{r}
# 10304, winter
hydro_winter_10304_pred_uni_2 <- predict(gam2_uni_selected_winter_10304, hydro_winter_10304_test, type = "response")
roc.plot(hydro_winter_10304_test$lowlevel, hydro_winter_10304_pred_uni_2, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_winter_10304_test$lowlevel, hydro_winter_10304_pred_uni_2)
hydro_winter_10304_pred_uni_2_lowlevel <- hydro_winter_10304_pred_uni_2[which(hydro_winter_10304_test$lowlevel == 1)]
hist(hydro_winter_10304_pred_uni_2_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Isar Mittenwald, Winter, Fälle: Niedrigwasserevent")
hydro_winter_10304_pred_uni_2_not_lowlevel <- hydro_winter_10304_pred_uni_2[-which(hydro_winter_10304_test$lowlevel == 1)]
hist(hydro_winter_10304_pred_uni_2_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Isar Mittenwald, Winter, Fälle: kein Niedrigwasserevent")

# 10304, summer
hydro_summer_10304_pred_uni_2 <- predict(gam2_uni_selected_summer_10304, hydro_summer_10304_test, type = "response")
roc.plot(hydro_summer_10304_test$lowlevel, hydro_summer_10304_pred_uni_2, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_summer_10304_test$lowlevel, hydro_summer_10304_pred_uni_2)
hydro_summer_10304_pred_uni_2_lowlevel <- hydro_summer_10304_pred_uni_2[which(hydro_summer_10304_test$lowlevel == 1)]
hist(hydro_summer_10304_pred_uni_2_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Isar Mittenwald, Sommer, Fälle: Niedrigwasserevent")
hydro_summer_10304_pred_uni_2_not_lowlevel <- hydro_summer_10304_pred_uni_2[-which(hydro_summer_10304_test$lowlevel == 1)]
hist(hydro_summer_10304_pred_uni_2_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Isar Mittenwald, Sommer, Fälle: kein Niedrigwasserevent")

# 11502, winter
hydro_winter_11502_pred_uni_2 <- predict(gam2_uni_selected_winter_11502, hydro_winter_11502_test, type = "response")
roc.plot(hydro_winter_11502_test$lowlevel, hydro_winter_11502_pred_uni_2, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_winter_11502_test$lowlevel, hydro_winter_11502_pred_uni_2)
hydro_winter_11502_pred_uni_2_lowlevel <- hydro_winter_11502_pred_uni_2[which(hydro_winter_11502_test$lowlevel == 1)]
hist(hydro_winter_11502_pred_uni_2_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Iller Kempten, Winter, Fälle: Niedrigwasserevent")
hydro_winter_11502_pred_uni_2_not_lowlevel <- hydro_winter_11502_pred_uni_2[-which(hydro_winter_11502_test$lowlevel == 1)]
hist(hydro_winter_11502_pred_uni_2_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Iller Kempten, Winter, Fälle: kein Niedrigwasserevent")

# 11502, summer
hydro_summer_11502_pred_uni_2 <- predict(gam2_uni_selected_summer_11502, hydro_summer_11502_test, type = "response")
roc.plot(hydro_summer_11502_test$lowlevel, hydro_summer_11502_pred_uni_2, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_summer_11502_test$lowlevel, hydro_summer_11502_pred_uni_2)
hydro_summer_11502_pred_uni_2_lowlevel <- hydro_summer_11502_pred_uni_2[which(hydro_summer_11502_test$lowlevel == 1)]
hist(hydro_summer_11502_pred_uni_2_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Iller Kempten, Sommer, Fälle: Niedrigwasserevent")
hydro_summer_11502_pred_uni_2_not_lowlevel <- hydro_summer_11502_pred_uni_2[-which(hydro_summer_11502_test$lowlevel == 1)]
hist(hydro_summer_11502_pred_uni_2_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Iller Kempten, Sommer, Fälle: kein Niedrigwasserevent")

# 20203, winter
hydro_winter_20203_pred_uni_2 <- predict(gam2_uni_selected_winter_20203, hydro_winter_20203_test, type = "response")
roc.plot(hydro_winter_20203_test$lowlevel, hydro_winter_20203_pred_uni_2, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_winter_20203_test$lowlevel, hydro_winter_20203_pred_uni_2)
hydro_winter_20203_pred_uni_2_lowlevel <- hydro_winter_20203_pred_uni_2[which(hydro_winter_20203_test$lowlevel == 1)]
hist(hydro_winter_20203_pred_uni_2_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Fränkische Saale Salz, Winter, Fälle: Niedrigwasserevent")
hydro_winter_20203_pred_uni_2_not_lowlevel <- hydro_winter_20203_pred_uni_2[-which(hydro_winter_20203_test$lowlevel == 1)]
hist(hydro_winter_20203_pred_uni_2_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Fränkische Saale Salz, Winter, Fälle: kein Niedrigwasserevent")

# 20203, summer
hydro_summer_20203_pred_uni_2 <- predict(gam2_uni_selected_summer_20203, hydro_summer_20203_test, type = "response")
roc.plot(hydro_summer_20203_test$lowlevel, hydro_summer_20203_pred_uni_2, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_summer_20203_test$lowlevel, hydro_summer_20203_pred_uni_2)
hydro_summer_20203_pred_uni_2_lowlevel <- hydro_summer_20203_pred_uni_2[which(hydro_summer_20203_test$lowlevel == 1)]
hist(hydro_summer_20203_pred_uni_2_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Fränkische Saale Salz, Sommer, Fälle: Niedrigwasserevent")
hydro_summer_20203_pred_uni_2_not_lowlevel <- hydro_summer_20203_pred_uni_2[-which(hydro_summer_20203_test$lowlevel == 1)]
hist(hydro_summer_20203_pred_uni_2_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Fränkische Saale Salz, Sommer, Fälle: kein Niedrigwasserevent")
```

## ROC Analysis for individual models ----
```{r}
# 10304, winter
hydro_winter_10304_pred <- predict(gam_uni_selected_interac_winter_10304, hydro_winter_10304_test, type = "response")
roc.plot(hydro_winter_10304_test$lowlevel, hydro_winter_10304_pred, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_winter_10304_test$lowlevel, hydro_winter_10304_pred)
hydro_winter_10304_pred_lowlevel <- hydro_winter_10304_pred[which(hydro_winter_10304_test$lowlevel == 1)]
hist(hydro_winter_10304_pred_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Isar Mittenwald, Winter, Fälle: Niedrigwasserevent")
hydro_winter_10304_pred_not_lowlevel <- hydro_winter_10304_pred[-which(hydro_winter_10304_test$lowlevel == 1)]
hist(hydro_winter_10304_pred_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Isar Mittenwald, Winter, Fälle: kein Niedrigwasserevent")

# 10304, summer
hydro_summer_10304_pred <- predict(gam_uni_selected_interac_summer_10304, hydro_summer_10304_test, type = "response")
roc.plot(hydro_summer_10304_test$lowlevel, hydro_summer_10304_pred, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_summer_10304_test$lowlevel, hydro_summer_10304_pred)
hydro_summer_10304_pred_lowlevel <- hydro_summer_10304_pred[which(hydro_summer_10304_test$lowlevel == 1)]
hist(hydro_summer_10304_pred_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Isar Mittenwald, Sommer, Fälle: Niedrigwasserevent")
hydro_summer_10304_pred_not_lowlevel <- hydro_summer_10304_pred[-which(hydro_summer_10304_test$lowlevel == 1)]
hist(hydro_summer_10304_pred_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Isar Mittenwald, Sommer, Fälle: kein Niedrigwasserevent")

# 11502, winter
hydro_winter_11502_pred <- predict(gam_uni_selected_interac_winter_11502, hydro_winter_11502_test, type = "response")
roc.plot(hydro_winter_11502_test$lowlevel, hydro_winter_11502_pred, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_winter_11502_test$lowlevel, hydro_winter_11502_pred)
hydro_winter_11502_pred_lowlevel <- hydro_winter_11502_pred[which(hydro_winter_11502_test$lowlevel == 1)]
hist(hydro_winter_11502_pred_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Iller Kempten, Winter, Fälle: Niedrigwasserevent")
hydro_winter_11502_pred_not_lowlevel <- hydro_winter_11502_pred[-which(hydro_winter_11502_test$lowlevel == 1)]
hist(hydro_winter_11502_pred_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Iller Kempten, Winter, Fälle: kein Niedrigwasserevent")

# 11502, summer
hydro_summer_11502_pred <- predict(gam_uni_selected_interac_summer_11502, hydro_summer_11502_test, type = "response")
roc.plot(hydro_summer_11502_test$lowlevel, hydro_summer_11502_pred, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_summer_11502_test$lowlevel, hydro_summer_11502_pred)
hydro_summer_11502_pred_lowlevel <- hydro_summer_11502_pred[which(hydro_summer_11502_test$lowlevel == 1)]
hist(hydro_summer_11502_pred_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Iller Kempten, Sommer, Fälle: Niedrigwasserevent")
hydro_summer_11502_pred_not_lowlevel <- hydro_summer_11502_pred[-which(hydro_summer_11502_test$lowlevel == 1)]
hist(hydro_summer_11502_pred_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Iller Kempten, Sommer, Fälle: kein Niedrigwasserevent")

# 20203, winter
hydro_winter_20203_pred <- predict(gam_uni_selected_interac_winter_20203, hydro_winter_20203_test, type = "response")
roc.plot(hydro_winter_20203_test$lowlevel, hydro_winter_20203_pred, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_winter_20203_test$lowlevel, hydro_winter_20203_pred)
hydro_winter_20203_pred_lowlevel <- hydro_winter_20203_pred[which(hydro_winter_20203_test$lowlevel == 1)]
hist(hydro_winter_20203_pred_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Fränkische Saale Salz, Winter, Fälle: Niedrigwasserevent")
hydro_winter_20203_pred_not_lowlevel <- hydro_winter_20203_pred[-which(hydro_winter_20203_test$lowlevel == 1)]
hist(hydro_winter_20203_pred_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Fränkische Saale Salz, Winter, Fälle: kein Niedrigwasserevent")

# 20203, summer
hydro_summer_20203_pred <- predict(gam_uni_selected_interac_summer_20203, hydro_summer_20203_test, type = "response")
roc.plot(hydro_summer_20203_test$lowlevel, hydro_summer_20203_pred, xlab = "1 - Spezifität", ylab = "Sensitivität", plot.thres = c(0.01, 0.1, 0.5, 0.9), cex.lab = 1.5)
auc(hydro_summer_20203_test$lowlevel, hydro_summer_20203_pred)
hydro_summer_20203_pred_lowlevel <- hydro_summer_20203_pred[which(hydro_summer_20203_test$lowlevel == 1)]
hist(hydro_summer_20203_pred_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Fränkische Saale Salz, Sommer, Fälle: Niedrigwasserevent")
hydro_summer_20203_pred_not_lowlevel <- hydro_summer_20203_pred[-which(hydro_summer_20203_test$lowlevel == 1)]
hist(hydro_summer_20203_pred_not_lowlevel, na.rm = TRUE, breaks = 100, xlab = "Prädiktierte Wahrscheinlichkeit für Niedrigwasserevent", ylab = "Häufigkeit", main = "Fränkische Saale Salz, Sommer, Fälle: kein Niedrigwasserevent")
```


